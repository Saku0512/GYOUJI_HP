function r(r){return"string"!=typeof r?r:r.trim().replace(/<[^>]*>/g,"").replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"").replace(/on\w+\s*=\s*["'][^"']*["']/gi,"").replace(/javascript:/gi,"").replace(/[<>&"']/g,r=>({"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&#x27;"}[r]))}function i(r){if("string"!=typeof r)return{isValid:!0,error:null};const i=[/(\b(SELECT|INSERT|UPDATE|DELETE|DROP|CREATE|ALTER|EXEC|EXECUTE|UNION|SCRIPT)\b)/gi,/(--|\/\*|\*\/|;|'|"|`)/g,/(\bOR\b|\bAND\b).*(\b=\b|\b<\b|\b>\b)/gi];for(const e of i)if(e.test(r))return{isValid:!1,error:"不正な文字が含まれています"};return{isValid:!0,error:null}}function e(r){if("string"!=typeof r)return{isValid:!0,error:null};const i=[/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,/<iframe\b[^<]*(?:(?!<\/iframe>)<[^<]*)*<\/iframe>/gi,/<object\b[^<]*(?:(?!<\/object>)<[^<]*)*<\/object>/gi,/<embed\b[^<]*(?:(?!<\/embed>)<[^<]*)*<\/embed>/gi,/on\w+\s*=\s*["'][^"']*["']/gi,/javascript:/gi,/vbscript:/gi,/data:text\/html/gi];for(const e of i)if(e.test(r))return{isValid:!1,error:"不正なスクリプトが含まれています"};return{isValid:!0,error:null}}function t(r,i=0,e=1/0,t="フィールド"){if("string"!=typeof r)return{isValid:!1,error:`${t}は文字列である必要があります`};const s=r.trim().length;return s<i?{isValid:!1,error:`${t}は${i}文字以上である必要があります`}:s>e?{isValid:!1,error:`${t}は${e}文字以下である必要があります`}:{isValid:!0,error:null}}function s(s,n){const o={};if(s&&0!==s.trim().length){const n=i(s);if(n.isValid){const i=e(s);if(i.isValid){const i=t(r(s),1,50,"ユーザー名");i.isValid||(o.username=i.error)}else o.username=i.error}else o.username=n.error}else o.username="ユーザー名は必須です";if(n&&0!==n.length){const r=t(n,1,100,"パスワード");r.isValid||(o.password=r.error)}else o.password="パスワードは必須です";return{isValid:0===Object.keys(o).length,errors:o,sanitizedData:{username:s?r(s):"",password:n||""}}}function n(t,s="スコア"){if(null==t||""===t)return{isValid:!1,error:`${s}は必須です`};let n=t;if("string"==typeof t){const s=i(t);if(!s.isValid)return{isValid:!1,error:s.error};const o=e(t);if(!o.isValid)return{isValid:!1,error:o.error};n=r(t)}const o=function(r,i=-1/0,e=1/0,t="値"){const s=Number(r);return isNaN(s)?{isValid:!1,error:`${t}は数値である必要があります`}:s<i?{isValid:!1,error:`${t}は${i}以上である必要があります`}:s>e?{isValid:!1,error:`${t}は${e}以下である必要があります`}:{isValid:!0,error:null}}(n,0,999,s);return o.isValid?{isValid:!0,error:null,sanitizedValue:Number(n)}:o}function o(r,i,e="",t=""){const s={},o={},l=n(r,"チーム1のスコア");l.isValid?o.score1=l.sanitizedValue:s.score1=l.error;const c=n(i,"チーム2のスコア");if(c.isValid?o.score2=c.sanitizedValue:s.score2=c.error,e){const r=a(e);r.isValid?o.team1=r.sanitizedValue:s.team1=r.error}if(t){const r=a(t);r.isValid?o.team2=r.sanitizedValue:s.team2=r.error}return void 0!==o.score1&&void 0!==o.score2&&o.score1===o.score2&&(s.general="引き分けは許可されていません"),{isValid:0===Object.keys(s).length,errors:s,sanitizedData:o}}function a(s){if(!s||0===s.trim().length)return{isValid:!1,error:"チーム名は必須です"};const n=i(s);if(!n.isValid)return n;const o=e(s);if(!o.isValid)return o;const a=r(s),l=t(a,1,50,"チーム名");return l.isValid?{isValid:!0,error:null,sanitizedValue:a}:l}function l(r,i){let e;return function(...t){clearTimeout(e),e=setTimeout(()=>{clearTimeout(e),r(...t)},i)}}export{s as a,l as d,o as v};
